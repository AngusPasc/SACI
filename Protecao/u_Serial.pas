unit u_Serial;

interface

uses Windows, Messages, SysUtils, Variants, Classes;

type
  TRegistro = (trCodigo,trSerial,trNome,trCNPJ,trIE);
  TSerial = class
  private
    FLista: TStringList;
  public
    constructor Create;
    function ExisteSerial(sSerial: String; var sCodigo,sNome,sCNPJ,sIE: String): Boolean;
    property Lista: TStringList read FLista write FLista;
  end;

implementation

{ TSerial }

constructor TSerial.Create;
begin
  FLista := TStringList.Create;
  FLista.Clear;

//Serial de teste
  FLista.Add('<CODIGO>0002</CODIGO>'+
             '<NOME>TESTE</NOME>'+
             '<CNPJ>00000000000000</CNPJ>'+
             '<IE>0000000000</IE>'+
             '<SERIAL>987C3198-41AB-484E-873D-E5C48B03CD1A</SERIAL>');

//Cliente boleto Bancário
  FLista.Add('<CODIGO>0003</CODIGO>'+
             '<NOME>ANTONIO JAKSON PINHEIRO ME</NOME>'+
             '<CNPJ>00400972000173</CNPJ>'+
             '<IE>069468117</IE>'+
             '<SERIAL>1187E66B-806C-4062-90EC-D38958C8724D</SERIAL>');

  FLista.Add('<CODIGO>0004</CODIGO>'+
             '<NOME>NÃO IDENTIFICADA</NOME>'+
             '<CNPJ></CNPJ>'+
             '<IE></IE>'+
             '<SERIAL>DF35CFBC-2805-4123-9435-8104228DD1F7</SERIAL>');
  FLista.Add('<CODIGO>0005</CODIGO>'+
             '<NOME>NÃO IDENTIFICADA</NOME>'+
             '<CNPJ></CNPJ>'+
             '<IE></IE>'+
             '<SERIAL>4634FF6A-A5AA-496D-8D29-2BE6D8BDAE8C</SERIAL>');
  FLista.Add('<CODIGO>0005</CODIGO>'+
             '<NOME>NÃO IDENTIFICADA</NOME>'+
             '<CNPJ></CNPJ>'+
             '<IE></IE>'+
             '<SERIAL>E33F9995-C614-436E-B86F-5A2E8DDF6C33</SERIAL>');
  {
  FLista.Add('878F0CF3-DD21-4E9E-9EDC-1432A84128AF');
  FLista.Add('F9E1740D-AAE5-4BC3-BA18-FD5567700196');
  FLista.Add('3DD3A4BE-5A6D-4E10-A79C-8643622E51CF');
  FLista.Add('5469994D-3C93-48AB-8DC9-FABF75654196');
  FLista.Add('98C3826E-4F8B-4F3D-8753-74688B2BD638');
  FLista.Add('9678A435-022E-49AC-B5ED-6780D7941EA7');
  FLista.Add('498DBFBA-7F15-435D-97F9-A2E913A68990');
  FLista.Add('10AF23D7-D0E8-4E41-A5E6-4A51FD28F968');
  FLista.Add('2E8552DB-CDD7-459B-8F94-BF950A128484');
  FLista.Add('3AE70B46-7630-4007-A25C-BEB6B36BDBE8');
  FLista.Add('F7E43223-B37A-42FB-A2D3-35F72E97073A');
  FLista.Add('A14485B0-09E9-4914-8858-8300198AE966');
  FLista.Add('E3CCA929-E676-43E3-AE25-7D565F4DD8CA');
  FLista.Add('041938C8-0EB5-4780-A96C-AE059D4BD6F3');
  FLista.Add('EC86E127-37BD-46CC-BBA4-261A846C84AC');
  FLista.Add('1DC29720-A6CA-47FA-A92F-83229BA8F9C9');
  FLista.Add('858CCBEF-2390-405E-9C24-B2774B81BFCB');
  FLista.Add('86FE5D57-0531-477A-A562-DC88DD66BEA7');
  FLista.Add('BE9DBEF5-B77E-42FD-BFA4-88C655A1C82E');
  FLista.Add('99893CDD-3125-4B16-9FAC-B11558F6A15C');
  FLista.Add('4D555D19-F3E7-485B-AF81-8A4BDBA0177A');
  FLista.Add('D64752E8-83A2-4907-A037-A77D1F86BC51');
  FLista.Add('009AC71B-BE09-4526-BE5C-B663A2E46B57');
  FLista.Add('3EA34C7C-490A-40B4-88B6-7451B61CD5B0');
  FLista.Add('79E4BD9B-9749-43EF-8C8F-EA33A8D3E121');
  FLista.Add('E1869221-C84D-4C9E-B82A-56FC0DCBDBDF');
  FLista.Add('A944E953-1343-4534-B1BA-185513286729');
  FLista.Add('55D5F09D-1B15-4E63-AB89-F00594DC576E');
  FLista.Add('D7F525B8-F763-47B7-944F-B54FF1EA5AFD');
  FLista.Add('83194D0E-8A1A-4916-BFFE-C7115491405D');
  FLista.Add('4B8A5EC3-54FB-4A01-AFA3-79857B29BE0A');
  FLista.Add('D897DEA1-DC7E-44EE-AF70-D84EB39C4EF7');
  FLista.Add('A1582B2E-9BF2-42C2-9185-80173383918B');
  FLista.Add('6AFDF305-4737-4157-99DA-1404779E65D6');
  FLista.Add('F5AA40D1-3397-4160-9F18-C75823E788CC');
  FLista.Add('68397D59-7F2A-4827-9D1A-EB88E1FF1122');
  FLista.Add('2FCDDA2F-FFDF-40AF-9740-0A46616ACCE7');
  FLista.Add('B79B9852-D963-4FA9-BA33-C5C423C69CE8');
  FLista.Add('B019E30C-C7E2-460C-8181-9FD152174BD1');
  FLista.Add('024552EA-65AC-46F4-8052-3D2B32EFC185');
  FLista.Add('5145FE8F-4D59-462D-9DEE-72880FFE019B');
  FLista.Add('2BD75A0B-C59B-4657-9426-958283CAA769');
  FLista.Add('27916CCC-D1C0-4589-A783-906BABB3D1E1');
  FLista.Add('2DBDEC95-C1E4-4671-AD55-D908A89A2677');
  FLista.Add('F0D37F0B-0E88-44B3-83D4-F7A9D1422E98');
  FLista.Add('60D6C132-132D-475D-BA45-15DB87372991');
  FLista.Add('76107A94-469D-45BA-916F-3C971692EBB9');
  FLista.Add('97E047C8-6952-4C48-915D-B275C889069E');
  FLista.Add('17AB8172-192F-4492-A669-DB40C9A8BC5A');
  FLista.Add('BC4B5650-E260-4F46-8B5D-0B5934A99552');
  FLista.Add('D837254F-D90B-441A-8C0B-3EC0BB72CEAD');
  FLista.Add('85165FEA-DDF8-4B46-8155-6E49088901DC');
  FLista.Add('20EE4D29-933C-46E9-B453-8398052FBAEF');
  FLista.Add('A8A84B8A-D2D6-4CB9-B01C-4B6BAD4F8C1B');
  FLista.Add('D540A7CA-573A-4AE0-9FA1-BA1890E62309');
  FLista.Add('4BDB6928-F75B-4F38-9FAC-16B40C148011');
  FLista.Add('9B62D2E4-B84C-45DD-94A5-BF1708A5237B');
  FLista.Add('5C2F1D98-246F-45AF-AC02-F5EA26EC60F2');
  FLista.Add('758D943D-05AF-4FD5-8B9F-1549AB81ABD4');
  FLista.Add('673D0FDD-1E15-48CB-BA18-4A188E862DE4');
  FLista.Add('52082691-70E9-4969-A267-A7D03B14666A');
  FLista.Add('59AB147C-94C4-44B8-94FF-C82BD0584702');
  FLista.Add('463913E0-A998-4C4A-9746-F1146E603E4E');
  FLista.Add('9B7F33DA-3277-4FD6-9738-5CFBD9F7CF17');
  FLista.Add('A361727A-6032-4780-887C-E3C170D2DFED');
  FLista.Add('D9613B31-8CCB-472B-932B-33D445709000');
  FLista.Add('480B39A5-8C99-4E3A-AE43-A09564198986');
  FLista.Add('4EB966A8-C135-48DC-9A16-4C9EA77554EF');
  FLista.Add('8B6E2304-E5CC-487A-B41C-445707BC7982');
  FLista.Add('4841810C-7A24-4BE8-839C-B08F9E476644');
  FLista.Add('2C1494FC-E52F-467C-B726-78DA17121FA1');
  FLista.Add('A46A4E32-9FE7-4A4E-B14C-3B380AE633FD');
  FLista.Add('8981EAA6-E76D-434F-8FAC-A72089659826');
  FLista.Add('3659D9CA-42A8-4979-82F5-B4CC4FA9C98B');
  FLista.Add('8AD79C4D-55F9-4CAA-B87A-723BBC38D7DB');
  FLista.Add('71C33865-8493-4E24-B8CC-F91DC3974089');
  FLista.Add('F4CF1712-1077-45D2-9C3E-A8CE5F7BFE85');
  FLista.Add('AE94FCF4-BF3F-4BA9-A66D-F439A61A7E54');
  FLista.Add('77469B24-0606-41F7-8345-B66C8119A8DF');
  FLista.Add('DAE39908-162A-4BA3-8657-79CEA440F4E6');
  FLista.Add('C7C3085C-0EE2-429D-8216-CB4E00FB692A');
  FLista.Add('62B63894-5BEE-4FD7-B5FA-C47516076B6D');
  FLista.Add('33D2F8B8-905C-4BF4-B9D3-4D4F5AFF7423');
  FLista.Add('2922C3B9-FA91-400A-AD22-877B37EB738B');
  FLista.Add('B326B48B-43F4-4772-9418-C2608239CDCE');
  FLista.Add('AC724B51-C74A-4BA5-A587-3FB4A4BCB18D');
  FLista.Add('CF557CC0-D572-4B1A-A2D6-F348E4756BA5');
  FLista.Add('C5080520-CC67-4BDF-B6C1-FBE364FB8A56');
  FLista.Add('E081929B-AC0D-41EA-8D26-96E85D860DB7');
  FLista.Add('71C2DBF0-F16E-4FA2-B77A-AC2ADD427234');
  FLista.Add('EA688D60-FAF7-415A-9BDB-092A422AD40E');
  FLista.Add('135809DC-6054-4D55-867A-4CCEE3170EB1');
  FLista.Add('7E60A80A-485A-45C7-8765-7D3E1D3BD2E9');
  FLista.Add('CC5639C8-E789-469D-B131-5AA6AA2A63A2');
  FLista.Add('F45B2B3F-329D-46C1-8C9D-7D4B36886930');
  FLista.Add('731812EE-1332-4298-A686-C19CBAC964C0');
  FLista.Add('AEC26A90-E081-4B29-855E-7F3088E104FC');
  FLista.Add('BC430B1E-4766-4202-B3FA-448BE6252075');
  FLista.Add('B010581F-BF7E-4232-A347-3328796E6D63');
  FLista.Add('36EE7256-1FDF-417E-BFED-48C8F4E75A22');
  FLista.Add('0EED054D-7E3E-4677-B9C2-4B363B3745E6');
  FLista.Add('6428A157-CB99-4391-BDC7-ABC2D9DAEB59');
  FLista.Add('C9F7DAFD-0C3D-4C00-8A5B-56354633C9FC');
  FLista.Add('8AB50C9F-8EF2-4B64-8FFC-A7899D348FB8');
  FLista.Add('56A5730E-697F-4B31-B502-251CA175ED41');
  FLista.Add('0528CB90-F695-4E35-ADFC-B13317DBC981');
  FLista.Add('D101D57A-5DEE-4603-9F19-4D07C8F6FAF0');
  FLista.Add('2F16A3D1-74BB-41A6-9B6C-A0238CA45D71');
  FLista.Add('12BBD0EF-5FBE-420D-BE8A-FE1C1E5626FE');
  FLista.Add('94841A99-077C-4174-B974-D9638A35FB41');
  FLista.Add('C9604C6C-4A4B-403B-9D94-118562A58FBA');
  FLista.Add('85DEB2E1-7BFC-4BFD-B917-8CD65CF5BFE3');
  FLista.Add('4D3238E4-A797-4C0D-A651-81CC37FC15D9');
  FLista.Add('A4AF9183-E354-4669-9B22-E7A1F973C1ED');
  FLista.Add('6DE6502E-F80C-43F2-89EF-73EF8AB325E1');
  FLista.Add('5C43095D-105A-4F50-835E-0D96645FF554');
  FLista.Add('CA68040E-42EE-4FB5-AAA7-9FDB3B91830E');
  FLista.Add('579E8A31-D748-41D5-8931-40954DF64598');
  FLista.Add('1C145342-C0C9-4F38-AC56-1CA5B130C7DA');
  FLista.Add('704E9E49-6F0D-4442-9D5E-8D02FB559ED4');
  FLista.Add('075F4AE4-08CE-4D24-AD4E-F94D8630A5DB');
  FLista.Add('850DB32A-D12C-41AC-A7F7-3DFCC7FD4FEE');
  FLista.Add('DB3056BB-5E87-4122-86F8-D449A3B7E2D6');
  FLista.Add('3662DEC7-BB14-43F0-8E21-1C4C2A580C2F');
  FLista.Add('6927A592-2214-47BE-A99C-05B401DB5D13');
  FLista.Add('FACA6F9F-B91D-4344-AAD2-B458EF9609D6');
  FLista.Add('737817D1-9455-4C79-A71E-E41754C470F5');
  FLista.Add('CF73929A-6832-4854-9E1B-6CEAD9320F79');
  FLista.Add('0620D5F4-3A82-4335-9483-470564B4AF74');
  FLista.Add('C818D095-BC81-476E-B7BC-A969B84B9B8A');
  FLista.Add('DF2E932D-71A5-4DDE-B6A2-EFA9C50834B5');
  FLista.Add('FA94F395-656A-4E70-AB9D-A9A5B1670B60');
  FLista.Add('FF1A983F-A9A1-4D3A-AEFE-7A5529A9DF33');
  FLista.Add('4DFC1FCD-C5D0-423C-8EBB-76D470BB5140');
  FLista.Add('4B259C42-128F-4D9B-942D-B22402571857');
  FLista.Add('320C737F-6838-42EE-B366-72CBDEAFD1BD');
  FLista.Add('606B40A8-AC1C-47AE-8F9D-07454C16497C');
  FLista.Add('EB423E2A-1D87-467F-A7DD-D68C3318BE55');
  FLista.Add('CC6D5DFC-BC5C-46B9-A2D0-23DD00CD441E');
  FLista.Add('9BB28A44-80E2-464C-AD06-24531BBFE0D4');
  FLista.Add('F91CDA01-83E8-4166-9877-1871113349E0');
  FLista.Add('3C3747C5-9FCA-4DD0-AA75-5B2971CB5123');
  FLista.Add('7680858C-CCC8-48C3-AA94-8DD1C4619D0C');
  FLista.Add('479E18A8-4F20-4C43-83EB-542B138D7CA3');
  FLista.Add('D5FB0EDB-E657-4152-AF6F-16281FA52FCA');
  FLista.Add('B8D1C0F6-8371-48CF-88DE-2ACF7234E634');
  FLista.Add('0DB3004B-1172-4780-A010-120F15FA1135');
  FLista.Add('1EB06AFE-8B00-43BE-8455-0A1B3B34D38C');
  FLista.Add('49D6A82E-8771-4F9E-AE53-E209F9075C07');
  FLista.Add('5463B04E-AF48-4603-818E-9A52630FDAEF');
  FLista.Add('1F1BD0E5-C5C4-466D-8759-80A66618C34E');
  FLista.Add('C79139F2-C828-4125-80E8-FD3B08F065E1');
  FLista.Add('6FF4F2B5-1EFD-406C-AF09-0985F6BF7DC6');
  FLista.Add('94CFC4EA-1E01-4D8B-91DA-D11D927B19FF');
  FLista.Add('7F13D352-5AD6-4715-9197-429E0A4CC090');
  FLista.Add('C9A11129-E492-4EB6-9FFC-34A682B1848C');
  FLista.Add('EE7A6707-BDB4-48C4-8EE3-3B29241F224D');
  FLista.Add('DC323958-7C6F-40F4-B364-C9A8F775B6B7');
  FLista.Add('88119DB1-795A-4D75-9F9F-1DDBC3B03F93');
  FLista.Add('171F9913-B059-4B60-8C73-033EAF412ADB');
  FLista.Add('2FF57F66-6ACB-4450-8887-B56E65470367');
  FLista.Add('70A33983-9D37-4072-B5CD-315F13C2DC6F');
  FLista.Add('2AE91857-8F16-4071-96B2-BEBF322B8B1D');
  FLista.Add('62B07092-2DF6-4774-A1D1-5049080A173B');
  FLista.Add('FE7D3DEC-2406-4BDC-97DB-A2C5BAC99F9C');
  FLista.Add('883B7414-61A7-4EA8-848E-64322A392E47');
  FLista.Add('1D6B6A7C-5057-4521-B632-5D6F3646E551');
  FLista.Add('7748E166-DA40-4190-A7A4-80451E7656D1');
  FLista.Add('236148AC-E67A-4D5B-9D3C-B01F85B75A96');
  FLista.Add('73186891-C068-454D-A262-1795A97A4B8A');
  FLista.Add('B802D543-6458-4560-AF20-CEE0E2F244A5');
  FLista.Add('35EDB0DB-8283-4A8B-9BC8-8771A9145D77');
  FLista.Add('8F31890A-54B0-4ADB-B21A-619FFE6A51ED');
  FLista.Add('AFBF3EB0-3385-4AB8-A971-C7EEA4A2F1FF');
  FLista.Add('DCC1BAA0-0D70-4CE8-A824-23E00DA60E2D');
  FLista.Add('654F16D3-50C1-4689-902C-6C17BE289594');
  FLista.Add('71615849-DD0A-4731-9F29-2F3FEEC0F93B');
  FLista.Add('7CA90AF4-CE54-43F0-BA4C-1B2F1DAEAA32');
  FLista.Add('0AF5342D-B4F3-46F2-871D-7D4272DB1AE3');
  FLista.Add('38D94C33-5046-4186-9872-537406E3DDD3');
  FLista.Add('8FAB5B8C-5EA6-4008-A768-032E2D593CA1');
  FLista.Add('8D8B2A99-0DEE-458C-82A6-425A74F39A8F');
  FLista.Add('4B8F8B0B-994E-4ED8-8B4C-8BC38031915B');
  FLista.Add('7ABB09EA-D878-4B8C-884B-5FF68C3B3EF0');
  FLista.Add('8841B286-5F8B-46C0-8953-4948BBAFD667');
  FLista.Add('84F3D379-181A-421C-B35F-3F7D4EFD08D9');
  FLista.Add('48BABAD9-CEE0-404B-8DEE-DF872191D44E');
  FLista.Add('D5119E92-59C9-4340-89CA-9941FB6573D2');
  FLista.Add('4A96BB23-9050-4EDA-AC44-B9E97F2B9A0E');
  FLista.Add('2E6A4E5F-17AE-4B5F-B696-2D89B439459C');
  FLista.Add('B20CF527-5152-4D61-B1A1-6ED0E9C6BEC7');
  FLista.Add('D0EE6180-A951-4A59-BFCE-C8DB37C6C769');
  FLista.Add('55761CED-655F-4D40-9795-A79FC98E934C');
  FLista.Add('CDBEFB4F-F04D-4D6A-B3D3-3D24D1F7B554');
  }
end;

function TSerial.ExisteSerial(sSerial: String;
  var sCodigo,sNome,sCNPJ,sIE: String): Boolean;
var
  i,j: integer;
  startRegistro,startValor: boolean;
  sRegistro,sValor,sCodigo_,sNome_,sCNPJ_,sIE_: string;
begin
  Result        := false;
  sRegistro     := '';
  sValor        := '';
  startRegistro := false;
  startValor    := false;

  for i := 0 to FLista.Count - 1 do
  begin
    for j := 1 to Length(FLista.Strings[i]) do
    begin

      if FLista.Strings[i][j] = '<' then
      begin
        sRegistro := '';
        startRegistro := true;
        startValor    := false;
      end;

      if startRegistro then
        sRegistro := sRegistro + FLista.Strings[i][j];

      if startValor then
        sValor := sValor + FLista.Strings[i][j];

      if FLista.Strings[i][j] = '>' then
      begin
        sValor := '';
        startRegistro := false;
        startValor    := true;
      end;

      if sRegistro = '<CODIGO>' then
        sCodigo_ := sValor;

      if sRegistro = '<NOME>' then
        sNome_ := sValor;

      if sRegistro = '<CNPJ>' then
        sCNPJ_ := sValor;

      if sRegistro = '<IE>' then
        sIE_ := sValor;

      if sRegistro = '<SERIAL>' then
      begin
        if sSerial = sValor then
        begin
          Result  := true;
          sCodigo := sCodigo_;
          sNome   := sNome_;
          sCNPJ   := sCNPJ_;
          sIE     := sIE_;
          exit;
        end;
      end;

    end;
  end;
end;

end.
